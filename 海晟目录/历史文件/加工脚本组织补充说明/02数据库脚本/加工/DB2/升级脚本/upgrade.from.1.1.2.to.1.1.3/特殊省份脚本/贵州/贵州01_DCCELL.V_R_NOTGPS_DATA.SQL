--DROP VIEW DCCELL.V_R_NOTGPS_DATA;
CREATE VIEW DCCELL.V_R_NOTGPS_DATA
(
    NOTGPS_CLT_ID,
    BUSINESS_TYPE_EK,
    BILL_NO,
    BILL_NAME,
    OBJ_ID,
    OBJ_CD,
    OBJ_NAME,
    BIZ_DATE,
    LONGITUDE,
    LATITUDE,
    LONGITUDE_TRUE,
    LATITUDE_TRUE,
    TECHNICIAN_ID,
    ORG_UNIQUE_CD,
    PT_YEAR,
    DATA_STATE,
    ORG_CD,
    ORG_NAME,
    PROV,
    PROV_NAME,
    CITC,
    CITC_NAME,
    COUC,
    COUC_NAME,
    STAC,
    STAC_NAME,
    SSTC,
    SSTC_NAME
)
AS
SELECT M.NOTGPS_CLT_ID,
       M.BUSINESS_TYPE_EK,
       M.BILL_NO,
       M.BILL_NAME,
       M.OBJ_ID ,
       M.OBJ_CD,
       M.OBJ_NAME,
       M.BIZ_DATE,
       M.LONGITUDE,
       M.LATITUDE,
       M.LONGITUDE_TRUE,
       M.LATITUDE_TRUE,
       M.TLG_ID AS TECHNICIAN_ID,
       M.ORG_UNIQUE_CD,
       M.PT_YEAR,
       M.DATA_STATE,
       ORG.ORG_CD,
       ORG.ORG_NAME,
       ORG.PROV,
       ORG.PROV_NAME,
       ORG.CITC,
       ORG.CITC_NAME,
       ORG.COUC,
       ORG.COUC_NAME,
       ORG.STAC,
       ORG.STAC_NAME,
       ORG.SSTC,
       ORG.SSTC_NAME
  FROM PT_CM_NOTGPS_CLT M
       LEFT JOIN B_ORG ORG ON M.ORG_UNIQUE_CD=ORG.ORG_UNIQUE_CD AND ORG.ORG_TYPE='2' AND M.PT_YEAR=ORG.BUSINESS_YEAR
 WHERE M.DATA_STATE='1'
;