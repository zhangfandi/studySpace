--翻耕明细

SELECT
  A.TOWN_NAME,
  A.VAGE_NAME,
  A.FARMER_CD,
  B.APPROVE_AREA,
  A.PLOUGH_AREA,
  CASE WHEN A.IS_DEPTH_STAND = '1'
    THEN A.PLOUGH_AREA
  ELSE 0 END,
  A.PLOUGH_AREA / B.APPROVE_AREA,
  CASE WHEN A.IS_DEPTH_STAND = '1'
    THEN '是'
  ELSE '否' END,
  CASE WHEN A.IS_OPEN_TRENCH = '1'
    THEN '是'
  ELSE '否' END,
  CASE A.WORK_EFFECT_EVAL
  WHEN '01'
    THEN '好'
  WHEN '02'
    THEN '较好'
  WHEN '03'
    THEN '一般'
  WHEN '04'
    THEN '差' END,
  A.END_DATE
FROM
  R_PT_PLOUGH_FM_D A
  LEFT JOIN
  (
    SELECT DISTINCT
      FRM_CD            AS FARMER_CD,
      SUM(APPROVE_AREA) AS APPROVE_AREA
    FROM
      PC_AI_PLANT_APPLY
    WHERE
      DATA_STATE = '1'
      AND BIZ_YEAR = 2018
      AND AUDIT_STATE = '3' AND IS_INVALID_FLAG = '0'
    GROUP BY FRM_CD
  ) B ON A.FARMER_CD = B.FARMER_CD
WHERE
  A.DATA_STATE = '1'



